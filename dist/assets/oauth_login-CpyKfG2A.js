import{_ as K,r as p,o as O,u as Q,a as W,b as m,c as f,d as h,e as s,w as _,f as U,v as q,g as l,h as a,i as n,n as X,F as ee,j as te,k as le,l as k,p as ae,m as oe,E as I}from"./index-BGrd9utk.js";import{_ as se,S as re,R as ne}from"./register-BlpyMLoW.js";import{s as ie}from"./request-CYa1g-gG.js";const ue=g=>ie({url:"/oauth_user/login",method:"post",data:g}),C=g=>(ae("data-v-d8366ad4"),g=g(),oe(),g),de={class:"form-container drag-mod"},pe={class:"login-box boxItem"},me=C(()=>s("p",{class:"title"},"胖狐用户认证中心",-1)),ce=C(()=>s("button",{class:"form-btn loginBtn",type:"submit"},"登录",-1)),ge={class:"register-box boxItem",style:{}},ve=C(()=>s("p",{class:"title"},"胖狐用户注册中心",-1)),_e={style:{width:"100%"}},fe={style:{width:"100%"}},he={style:{width:"100%",height:"100%"}},ye={style:{width:"100%"}},be={style:{display:"flex","justify-content":"space-between"}},xe={__name:"oauth_login",setup(g){const c=p(null);let o=p({username:"",password:"",phone:"",nickname:"",email:"",code:"",sex:"",birthday:""}),u=p({username:"",password:"",redirect_url:"",state:"",client_id:""});function R(i,e,r){/^\d{6,}$/.test(e)?r():r(new Error("请输入六位或者六位以上的数字"))}function B(i,e,r){/^1[3-9]\d{9}$/.test(e)?r():r(new Error("请输入正确的手机号码(中国)"))}function E(i,e,r){/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)?r():r(new Error("请输入正确的邮箱地址"))}const F=p({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{validator:R,trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{validator:B,trigger:"blur"}],nickname:[{required:!0,message:"请输入用户昵称",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:E,trigger:"blur"}],code:[{required:!0,message:"请输入邮箱验证码",trigger:"blur"}],sex:[{required:!0,message:"请输入性别",trigger:"blur"}],birthday:[{required:!0,message:"请输入选择出生日期",trigger:"blur"}]}),y=p(null),S=()=>{w.value=!1,y.value.setActiveItem(0),o.value={username:"",password:"",phone:"",nickname:"",email:"",code:""},x.value=""};O(()=>{const i=window.location.hash.substring(1),e=new URLSearchParams(i);u.value.client_id=e.get("client_id")||V.query.client_id,u.value.state=e.get("state")||V.query.state,u.value.redirect_url=e.get("redirect_url")||V.query.redirect_url});let x=p("");const M=async()=>{c.value&&await c.value.validateField(["email"],async i=>{if(i){let{code:e}=await re({email:o.value.email});e===200&&(x.value=o.value.email,I.success("发送成功"))}})},N=p({0:["username","password"],1:["nickname","phone"],2:["sex","birthday"],3:["email","code"]}),A=async()=>{c.value&&await c.value.validate(async(i,e)=>{i&&(x.value!==o.value.email?alert("修改邮箱请重新获取验证码"):(await ne(o.value)).code===200&&(S(),I.success("注册成功")))})};let v=p(0);const Y=i=>{v.value=i},$=async()=>{c.value&&await c.value.validateField(N.value[v.value],i=>{i&&y.value.next()})},z=()=>{y.value.setActiveItem(v.value-1)},D=()=>{w.value=!0};let w=p(!1);const V=Q(),L=W(),P=async i=>{u.value.username&&u.value.password?u.value.redirect_url?await ue(u.value):await L.push({path:"/NotFound"}):alert("请输入账号和密码")};return(i,e)=>{const r=m("el-input"),d=m("el-form-item"),b=m("el-carousel-item"),Z=m("el-date-picker"),j=m("el-option"),T=m("el-select"),H=m("el-button"),G=m("el-carousel"),J=m("el-form");return f(),h("div",de,[s("div",{class:X(["box3d",{transformY:l(w)}])},[s("div",pe,[me,s("form",{class:"form no-drag",onSubmit:_(P,["prevent","stop"])},[U(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>l(u).username=t),type:"text",class:"input",placeholder:"用户账号"},null,512),[[q,l(u).username]]),U(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>l(u).password=t),type:"password",class:"input",placeholder:"密码"},null,512),[[q,l(u).password]]),s("button",{class:"form-btn-register form-btn loginBtn",onClick:_(D,["prevent"])},"用户注册"),ce],32)]),s("div",ge,[s("div",null,[s("img",{class:"backIcon",src:se,onClick:S,alt:"返回"})]),ve,a(J,{rules:F.value,ref_key:"registerFormRef",ref:c,model:l(o),"label-width":"auto"},{default:n(()=>[a(G,{ref_key:"carouselRef",ref:y,onChange:Y,height:"130px",interval:5e3,"indicator-position":"none",autoplay:!1,arrow:"never"},{default:n(()=>[a(b,null,{default:n(()=>[s("div",_e,[a(d,{prop:"username"},{default:n(()=>[a(r,{modelValue:l(o).username,"onUpdate:modelValue":e[2]||(e[2]=t=>l(o).username=t),style:{width:"300px",height:"40px"},placeholder:"用户名"},null,8,["modelValue"])]),_:1}),a(d,{prop:"password"},{default:n(()=>[a(r,{modelValue:l(o).password,"onUpdate:modelValue":e[3]||(e[3]=t=>l(o).password=t),type:"password",style:{width:"300px",height:"40px"},placeholder:"密码"},null,8,["modelValue"])]),_:1})])]),_:1}),a(b,null,{default:n(()=>[s("div",fe,[a(d,{prop:"nickname"},{default:n(()=>[a(r,{modelValue:l(o).nickname,"onUpdate:modelValue":e[4]||(e[4]=t=>l(o).nickname=t),style:{width:"300px",height:"40px"},placeholder:"昵称"},null,8,["modelValue"])]),_:1}),a(d,{prop:"phone"},{default:n(()=>[a(r,{modelValue:l(o).phone,"onUpdate:modelValue":e[5]||(e[5]=t=>l(o).phone=t),style:{width:"300px",height:"40px"},placeholder:"手机号码"},null,8,["modelValue"])]),_:1})])]),_:1}),a(b,null,{default:n(()=>[s("div",he,[a(d,{prop:"birthday"},{default:n(()=>[a(Z,{modelValue:l(o).birthday,"onUpdate:modelValue":e[6]||(e[6]=t=>l(o).birthday=t),type:"date",style:{width:"300px",height:"40px"},placeholder:"出生日期",format:"YYYY/MM/DD","value-format":"x"},null,8,["modelValue"])]),_:1}),a(d,{prop:"sex"},{default:n(()=>[a(T,{modelValue:l(o).sex,"onUpdate:modelValue":e[7]||(e[7]=t=>l(o).sex=t),placeholder:"Select",style:{width:"300px",height:"40px"}},{default:n(()=>[(f(),h(ee,null,te([{label:"男",value:"男"},{label:"女",value:"女"}],t=>a(j,{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})])]),_:1}),a(b,null,{default:n(()=>[s("div",ye,[a(d,{prop:"email"},{default:n(()=>[a(r,{modelValue:l(o).email,"onUpdate:modelValue":e[8]||(e[8]=t=>l(o).email=t),style:{width:"300px",height:"40px"},placeholder:"邮箱"},null,8,["modelValue"])]),_:1}),s("div",be,[a(d,{prop:"code"},{default:n(()=>[a(r,{modelValue:l(o).code,"onUpdate:modelValue":e[9]||(e[9]=t=>l(o).code=t),style:{height:"40px"},placeholder:"验证码"},null,8,["modelValue"])]),_:1}),a(H,{type:"primary",icon:"Iphone",onClick:_(M,["prevent"]),style:{"margin-left":"10px",width:"100px",height:"40px"},class:"loginBtn"},{default:n(()=>[le(" 验证码 ")]),_:1})])])]),_:1})]),_:1},512),l(v)!==3?(f(),h("button",{key:0,class:"form-btn loginBtn inputStyle",onClick:e[10]||(e[10]=_(t=>$(),["prevent"]))},"下一步 ")):k("",!0),l(v)===3?(f(),h("button",{key:1,class:"form-btn loginBtn inputStyle",onClick:_(A,["prevent","stop"])},"完成 ")):k("",!0),l(v)!==0?(f(),h("button",{key:2,class:"form-btn-register form-btn inputStyle",style:{"margin-top":"10px"},onClick:e[11]||(e[11]=_(t=>z(),["prevent"]))},"上一步 ")):k("",!0)]),_:1},8,["rules","model"])])],2)])}}},Ce=K(xe,[["__scopeId","data-v-d8366ad4"]]);export{Ce as default};
